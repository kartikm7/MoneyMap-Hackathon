<!-- reminders.ejs -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Reminders</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

<div id="reminders-app">
    <h1>Your Reminders</h1>

    <!-- Form for adding a new reminder -->
    <form id="addReminderForm" method="post" action="/add-reminder">
        <label for="amount">Amount:</label>
        <input type="number" name="amount" id="amount" required>

        <label for="date">Date:</label>
        <input type="date" name="date" id="date" required>

        <label for="service">Service:</label>
        <input type="text" name="service" id="service" required>

        <label for="name">Name:</label>
        <input type="text" name="name" id="name" required>

        <button type="submit">Add Reminder</button>
    </form>

    <!-- Button to set up a weekly email reminder -->
    <button id="setupWeeklyReminder">Set Up Weekly Reminder</button>

    <!-- List to display existing reminders -->
    <ul id="remindersList">
        <% for (const reminder of reminders) { %>
            <li>
                <span><strong>Name:</strong> <%= reminder.name %></span>
                <span><strong>Amount:</strong> <%= reminder.amount %></span>
                <span><strong>Date:</strong> <%= reminder.date %></span>
                <span><strong>Service:</strong> <%= reminder.service %></span>
            </li>
        <% } %>
    </ul>

</div>

<script>
    function formatDate(timestamp) {
        const date = new Date(timestamp.seconds * 1000); // Convert seconds to milliseconds
        return date.toLocaleDateString(); // Adjust the formatting as needed
    }
</script>


<script>
    // Function to format the date

    // Event listener for the "Set Up Weekly Reminder" button
    const setupWeeklyReminderButton = document.getElementById('setupWeeklyReminder');
    setupWeeklyReminderButton.addEventListener('click', async () => {
        const response = await fetch('/set-weekly-reminder', {
            method: 'POST',
        });

        if (response.ok) {
            const result = await response.json();
            const { success } = result;

            if (success) {
                alert('Weekly reminder set up successfully!');
            } else {
                alert('Failed to set up weekly reminder');
            }
        } else {
            alert('Failed to set up weekly reminder');
        }
    });
</script>

</body>
</html>
